{% extends "base.html" %}

{% block title %}{{ manga.title }} - Bölüm {{ chapter.number }}{% endblock %}

{% block content %}
<section class="section">
<h2>{{ manga.title }} - Bölüm {{ chapter.number }}</h2>
{% if chapter.title %}
    <h3>{{ chapter.title }}</h3>
{% endif %}

{% if last_page_number %}
    
{% endif %}

<div id="reader-root" class="mt-16"
     data-manga-id="{{ manga.id }}"
     data-chapter-id="{{ chapter.id }}">
    <div>
        {% for page in pages %}
            <div class="manga-page" data-page-number="{{ page.number }}">
                <img class="page-img" src="{{ page.image_path }}" alt="Page {{ page.number }}">
            </div>
        {% else %}
            <p>Bu bölüm için sayfa bulunamadı.</p>
        {% endfor %}
    </div>
</div>
</section>

<section class="section mt-16">
  <h3>Yorumlar</h3>
  <div class="comment-form">
    <form method="POST" action="{{ url_for('user_content.add_comment', manga_id=manga.id) }}" class="form">
      <input type="hidden" name="chapter_id" value="{{ chapter.id }}">
      <textarea name="content" placeholder="Yorum yaz..." required></textarea>
      <button type="submit" class="btn btn-outline">Yorum Gönder</button>
    </form>
  </div>
  <div class="comment-list mt-10">
    {% for c in comments %}
      <div class="comment">
        <div class="meta">{{ c.created_at.strftime('%Y-%m-%d %H:%M') }}</div>
        <div class="content">{{ c.content }}</div>
      </div>
    {% else %}
      <p>Bu chapter için yorum bulunamadı.</p>
    {% endfor %}
  </div>
</section>
 
{% endblock %}
